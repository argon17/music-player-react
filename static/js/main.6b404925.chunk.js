(this["webpackJsonpmusic-player-react"]=this["webpackJsonpmusic-player-react"]||[]).push([[0],{111:function(e,t,a){e.exports=a(140)},140:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(14),l=a.n(i),c=a(13),o=a(170),u=a(173),s=a(174),m=a(103),d=a(94),g=a.n(d),p=Object(o.a)((function(e){return{title:{marginLeft:e.spacing(1)}}}));var b=function(){var e=p();return r.a.createElement(u.a,{color:"primary",position:"fixed"},r.a.createElement(s.a,null,r.a.createElement(g.a,null),r.a.createElement(m.a,{className:e.title,variant:"h6",component:"h1"},"Music Player")))},f=a(55),v=a.n(f),E=a(18),h=a(26),y=a(74),O=a(201),S=a(175),j=a(176),x=a(198),N=a(177),w=a(178),C=a(179),k=a(180),I=a(181),P=a(61),q=a.n(P),T=a(52),_=a.n(T),F=a(32),A=a(199);function G(){var e=Object(F.a)(["\n    mutation addOrRemoveFromQueue($input: SongInput!){\n        addOrRemoveFromQueue(input: $input) @client    \n    }\n"]);return G=function(){return e},e}function Q(){var e=Object(F.a)(["\n    mutation addSong($title: String!, $artist: String!, $thumbnail: String!, $duration: Float!, $url: String!) {\n        insert_songs(objects: {title: $title, artist: $artist, thumbnail: $thumbnail, duration: $duration, url: $url}) {\n            affected_rows\n        }\n    }\n"]);return Q=function(){return e},e}var R=Object(A.a)(Q()),$=Object(A.a)(G()),D=a(29),U=Object(o.a)((function(e){return{container:{display:"flex",alignItems:"center"},urlInput:{margin:e.spacing(1)},addSongButton:{margin:e.spacing(1)},dialog:{textAlign:"center"},thumbnail:{width:"90%"}}})),B={artist:"",duration:0,thumbnail:"",title:"",url:""};var L=function(){var e=Object(D.a)(R),t=Object(c.a)(e,2),a=t[0],n=t[1].error,i=U(),l=r.a.useState(!1),o=Object(c.a)(l,2),u=o[0],s=o[1],m=r.a.useState(!1),d=Object(c.a)(m,2),g=d[0],p=d[1],b=r.a.useState(""),f=Object(c.a)(b,2),P=f[0],T=f[1],F=r.a.useState(B),A=Object(c.a)(F,2),G=A[0],Q=A[1];function $(){s(!1)}function L(){return(L=Object(y.a)(v.a.mark((function e(t){var a,n,r;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=t.player,(n=a.player.player).getVideoData&&(r=M(n)),Q(Object(h.a)({},r,{url:P}));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function M(e){var t=e.getDuration(),a=e.getVideoData(),n=a.title,r=a.video_id;return{artist:a.author,duration:t,thumbnail:"http://img.youtube.com/vi/".concat(r,"/0.jpg"),title:n}}function J(){return(J=Object(y.a)(v.a.mark((function e(){var t,n,r,i,l;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=G.artist,n=G.duration,r=G.thumbnail,i=G.title,l=G.url,e.prev=1,e.next=4,a({variables:{artist:t.length>0?t:null,duration:n>0?n:null,thumbnail:r.length>0?r:null,title:i.length>0?i:null,url:l.length>0?l:null}});case 4:$(),Q(B),T(""),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),console.log("Error adding song",G);case 12:case"end":return e.stop()}}),e,null,[[1,9]])})))).apply(this,arguments)}function W(e){var t=e.target,a=t.name,n=t.value;Q((function(e){return Object(h.a)({},e,Object(E.a)({},a,n))}))}function Y(e){var t,a;return null===n||void 0===n?void 0:null===(t=n.graphQLErrors[0])||void 0===t?void 0:null===(a=t.extensions)||void 0===a?void 0:a.path.includes(e)}r.a.useEffect((function(){var e=_.a.canPlay(P);p(e)}),[P]);var z=G.thumbnail,V=G.title,H=G.artist;return r.a.createElement("div",{className:i.container},r.a.createElement(O.a,{className:i.dialog,onClose:$,open:u},r.a.createElement(S.a,null,"Edit Song"),r.a.createElement(j.a,null,r.a.createElement("img",{alt:"Song Thumbnail",className:i.thumbnail,src:z}),r.a.createElement(x.a,{error:Y("title"),fullWidth:!0,helperText:Y("title")&&"Fill out field",label:"Title",margin:"dense",name:"title",onChange:W,value:V}),r.a.createElement(x.a,{error:Y("artist"),fullWidth:!0,helperText:Y("artist")&&"Fill out field",label:"Artist",margin:"dense",name:"artist",onChange:W,value:H}),r.a.createElement(x.a,{error:Y("thumbnail"),fullWidth:!0,helperText:Y("thumbnail")&&"Fill out field",margin:"dense",label:"Thumbnail",name:"thumbnail",onChange:W,value:z})),r.a.createElement(N.a,null,r.a.createElement(w.a,{color:"secondary",onClick:$},"Cancel"),r.a.createElement(w.a,{color:"primary",onClick:function(){return J.apply(this,arguments)},variant:"outlined"},"Add Song"))),r.a.createElement(x.a,{className:i.urlInput,fullWidth:!0,InputProps:{startAdornment:r.a.createElement(C.a,{position:"start"},r.a.createElement(k.a,null))},margin:"normal",onChange:function(e){return T(e.target.value)},placeholder:"Add YouTube URL",type:"url",value:P}),r.a.createElement(w.a,{className:i.addSongButton,color:"primary",disabled:!g,endIcon:r.a.createElement(I.a,null),onClick:function(){return s(!0)},variant:"contained"},"Add"),r.a.createElement(q.a,{url:P,hidden:!0,onReady:function(e){return L.apply(this,arguments)}}))},M=a(182),J=a(183),W=a(184),Y=a(185),z=a(186),V=a(187),H=a(188),K=a(189),X=a(190);function Z(){var e=Object(F.a)(["\n    subscription getSongs {\n        songs(order_by: {created_at: desc}) {\n            artist\n            duration\n            id\n            thumbnail\n            title\n            url\n        }\n    }\n"]);return Z=function(){return e},e}var ee=Object(A.a)(Z()),te=Object(n.createContext)({song:{id:"d9443a71-16ab-4a7e-aff7-1a226ddeb47b",title:"Pariah",artist:"Steven Wilson, Ninet Tayeb",thumbnail:"http://img.youtube.com/vi/cNTaFArEObU/0.jpg",url:"https://youtu.be/cNTaFArEObU",duration:279},isPlaying:!1});var ae=function(e,t){switch(t.type){case"PAUSE_SONG":return Object(h.a)({},e,{isPlaying:!1});case"PLAY_SONG":return Object(h.a)({},e,{isPlaying:!0});case"SET_SONG":return Object(h.a)({},e,{song:t.payload.song});default:return e}};var ne=Object(o.a)((function(e){return{container:{margin:e.spacing(1),background:"linear-gradient(to right, rgba(72, 85, 99, 0.5), rgba(41, 50, 60, 0.5))"},songInfoContainer:{alignItems:"center",display:"flex",justifyContent:"center"},songInfo:{display:"flex",justifyContent:"space-between",width:"100%"},thumbnail:{height:140,objectFit:"cover",width:140}}}));function re(e){var t=e.song,a=t.id,i=ne(),l=Object(n.useContext)(te),o=l.state,u=l.dispatch,s=t.artist,d=t.thumbnail,g=t.title,p=Object(n.useState)(!1),b=Object(c.a)(p,2),f=b[0],v=b[1],E=Object(D.a)($,{onCompleted:function(e){localStorage.setItem("queue",JSON.stringify(e.addOrRemoveFromQueue))}}),y=Object(c.a)(E,1)[0];return Object(n.useEffect)((function(){var e=o.isPlaying&&a===o.song.id;v(e)}),[a,o.song.id,o.isPlaying]),r.a.createElement(J.a,{className:i.container},r.a.createElement("div",{className:i.songInfoContainer},r.a.createElement(W.a,{className:i.thumbnail,image:d}),r.a.createElement("div",{className:i.songInfo},r.a.createElement(Y.a,null,r.a.createElement(m.a,{gutterBottom:!0,variant:"h5",component:"h2"},g),r.a.createElement(m.a,{gutterBottom:!0,variant:"body1",component:"p",color:"textSecondary"},s)),r.a.createElement(z.a,null,r.a.createElement(V.a,{onClick:function(){u({type:"SET_SONG",payload:{song:t}}),u({type:o.isPlaying?"PAUSE_SONG":"PLAY_SONG"})},size:"small",color:"secondary"},f?r.a.createElement(H.a,null):r.a.createElement(K.a,null)),r.a.createElement(V.a,{onClick:function(){y({variables:{input:Object(h.a)({},t,{__typename:"Song"})}})},size:"small",color:"secondary"},r.a.createElement(X.a,null))))))}var ie=function(){var e=Object(D.c)(ee),t=e.data,a=e.loading,n=e.error;return a?r.a.createElement("div",{style:{alignItems:"center",display:"flex",flexDirection:"column",marginTop:50}},r.a.createElement(M.a,null)):n?r.a.createElement("div",null,"error occured in fetching songs"):r.a.createElement("div",{className:"noob",style:{display:"flex",flexDirection:"column"}},t.songs.map((function(e){return r.a.createElement(re,{key:e.id,song:e})})))},le=a(191),ce=a(202),oe=a(192);var ue=Object(o.a)({avatar:{height:44,width:44},container:{alignItems:"center",display:"grid",gridAutoFlow:"column",gridGap:12,gridTemplateColumns:"50px auto 50px",marginTop:10},songInfoContainer:{overflow:"hidden",whiteSpace:"nowrap"},text:{overflow:"hidden",textOverflow:"ellipsis"}});function se(e){var t=e.song,a=ue(),n=t.artist,i=t.thumbnail,l=t.title,o=Object(D.a)($,{onCompleted:function(e){localStorage.setItem("queue",JSON.stringify(e.addOrRemoveFromQueue))}}),u=Object(c.a)(o,1)[0];return r.a.createElement("div",{className:a.container},r.a.createElement(ce.a,{className:a.avatar,src:i,alt:"Song thumbnail"}),r.a.createElement("div",{className:a.songInfoContainer},r.a.createElement(m.a,{variant:"subtitle2",className:a.text},l),r.a.createElement(m.a,{color:"textSecondary",variant:"body2",className:a.text},n)),r.a.createElement(V.a,{onClick:function(){u({variables:{input:Object(h.a)({},t,{__typename:"Song"})}})}},r.a.createElement(oe.a,{color:"error"})))}var me=function(e){var t=e.queue;return Object(le.a)((function(e){return e.breakpoints.up("md")}))&&r.a.createElement("div",{style:{margin:"10px 0"}},r.a.createElement(m.a,{color:"textSecondary",variant:"button"},"QUEUE(",t.length,")"),t.map((function(e,t){return r.a.createElement(se,{key:t,song:e})})))},de=a(203),ge=a(193),pe=a(194);function be(){var e=Object(F.a)(["\n    query getQueuedSongs{\n        queue @client {\n            id\n            duration\n            title\n            artist\n            thumbnail\n            url\n        }\n    }\n"]);return be=function(){return e},e}var fe=Object(A.a)(be()),ve=Object(o.a)((function(e){return{container:{display:"flex",justifyContent:"space-between",background:"linear-gradient(to right, rgba(72, 85, 99, 0.5), rgba(41, 50, 60, 0.5))"},content:{flex:"1 0 auto"},controls:{alignItems:"center",display:"flex",paddingLeft:e.spacing(1),paddingRight:e.spacing(1)},details:{display:"flex",flexDirection:"column",padding:"0px 15px"},playIcon:{height:38,width:38},thumbnail:{width:150}}}));var Ee=function(){var e=Object(n.useContext)(te),t=e.state,a=e.dispatch,i=Object(D.b)(fe).data,l=ve(),o=Object(n.useState)(0),u=Object(c.a)(o,2),s=u[0],d=u[1],g=Object(n.useState)(!1),p=Object(c.a)(g,2),b=p[0],f=p[1],v=Object(n.useRef)(),E=Object(n.useState)(0),h=Object(c.a)(E,2),y=h[0],O=h[1],S=Object(n.useState)(0),j=Object(c.a)(S,2),x=j[0],N=j[1];return Object(n.useEffect)((function(){var e=i.queue.findIndex((function(e){return e.id===t.song.id}));N(e)}),[t.song.id,i.queue]),Object(n.useEffect)((function(){var e=i.queue[x+1];1===s&&e&&(d(0),a({type:"SET_SONG",payload:{song:e}}))}),[i.queue,s,a,x]),r.a.createElement(r.a.Fragment,null,r.a.createElement(J.a,{className:l.container,variant:"outlined"},r.a.createElement("div",{className:l.details},r.a.createElement(Y.a,{className:l.content},r.a.createElement(m.a,{variant:"h5",component:"h3"},t.song.title),r.a.createElement(m.a,{variant:"subtitle1",component:"p",color:"textSecondary"},t.song.artist)),r.a.createElement("div",{className:l.controls},r.a.createElement(V.a,{onClick:function(){var e=i.queue[x-1];e&&a({type:"SET_SONG",payload:{song:e}})}},r.a.createElement(ge.a,null)),r.a.createElement(V.a,{onClick:function(){a({type:t.isPlaying?"PAUSE_SONG":"PLAY_SONG"})}},t.isPlaying?r.a.createElement(H.a,{className:l.playIcon}):r.a.createElement(K.a,{className:l.playIcon})),r.a.createElement(V.a,{onClick:function(){var e=i.queue[x+1];s&&e&&a({type:"SET_SONG",payload:{song:e}})}},r.a.createElement(pe.a,null)),r.a.createElement(m.a,{variant:"subtitle1",component:"p",color:"textSecondary"},new Date(1e3*y).toISOString().substr(11,8))),r.a.createElement(de.a,{max:1,min:0,onChange:function(e,t){d(t)},onMouseDown:function(){f(!0)},onMouseUp:function(){f(!1),v.current.seekTo(s)},step:.01,type:"range",value:s,color:"secondary"})),r.a.createElement(q.a,{hidden:!0,url:t.song.url,onProgress:function(e){var t=e.played,a=e.playedSeconds;b||(d(t),O(a))},playing:t.isPlaying,ref:v}),r.a.createElement(W.a,{className:l.thumbnail,image:t.song.thumbnail})),r.a.createElement(me,{queue:i.queue}))},he=a(195);var ye=function(){var e=Object(le.a)((function(e){return e.breakpoints.up("md")})),t=r.a.useContext(te),a=r.a.useReducer(ae,t),n=Object(c.a)(a,2),i=n[0],l=n[1];return e?r.a.createElement(te.Provider,{value:{state:i,dispatch:l}},r.a.createElement(b,null),r.a.createElement(he.a,{container:!0,spacing:3,style:{paddingTop:80}},r.a.createElement(he.a,{item:!0,xs:12,md:7},r.a.createElement(L,null),r.a.createElement(ie,null)),r.a.createElement(he.a,{item:!0,xs:12,md:5,style:{position:"fixed",right:0,top:70,width:"100%"}},r.a.createElement(Ee,null)))):r.a.createElement(r.a.Fragment,null,r.a.createElement(te.Provider,{value:{state:i,dispatch:l}},r.a.createElement(b,null),r.a.createElement(he.a,{container:!0,spacing:3,style:{paddingTop:80}},r.a.createElement(he.a,{item:!0,xs:12},r.a.createElement(Ee,null)),r.a.createElement(he.a,{item:!0,xs:12,style:{top:170,width:"100%"}},r.a.createElement(L,null),r.a.createElement(ie,null)))))},Oe=a(196),Se=a(197),je=a(99),xe=Object(je.a)({overrides:{MuiCssBaseline:{"@global":{body:{background:"linear-gradient(to right, #0f2027, #203a43, #2c5364)",backgroundRepeat:"no-repeat",backgroundAttachment:"fixed"}}}},palette:{type:"dark",primary:{main:"#2C5364"},secondary:{main:"#ffffff"}},typography:{fontFamily:"Ubuntu"}}),Ne=a(21),we=a(25),Ce=a(35),ke=a(98),Ie=a(100);function Pe(){var e=Object(F.a)(["\n        type Song {\n            id: uuid!,\n            title: String!,\n            artist: String!,\n            thumbnail: String!,\n            url: String!,\n            duration: Float!\n        }\n\n        input SongInput {\n            id: uuid!,\n            title: String!,\n            artist: String!,\n            thumbnail: String!,\n            url: String!,\n            duration: Float!\n        }\n\n        type Query{\n            queue: [Song]!\n        }\n\n        type Mutation{\n            addOrRemoveFromQueue(input: SongInput): [Song]!\n        }\n    "]);return Pe=function(){return e},e}var qe=new Ce.c({link:new ke.a({uri:"wss://react-music-player-argon.herokuapp.com/v1/graphql",options:{reconnect:!0}}),cache:new Ie.a,typeDefs:Object(A.a)(Pe()),resolvers:{Mutation:{addOrRemoveFromQueue:function(e,t,a){var n=t.input,r=a.cache,i=r.readQuery({query:fe});if(i){var l=i.queue,c=l.some((function(e){return e.id===n.id}))?l.filter((function(e){return e.id!==n.id})):[].concat(Object(we.a)(l),[n]);return r.writeQuery({query:fe,data:{queue:c}}),c}return[]}}}}),Te=localStorage.getItem("queue"),_e={queue:Boolean(Te)?JSON.parse(Te):[]};qe.writeData({data:_e});var Fe=qe;l.a.render(r.a.createElement(Ne.a,{client:Fe},r.a.createElement(Oe.a,{theme:xe},r.a.createElement(Se.a,null),r.a.createElement(ye,null))),document.getElementById("root"))}},[[111,1,2]]]);
//# sourceMappingURL=main.6b404925.chunk.js.map